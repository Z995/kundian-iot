import{_ as I,r as D,d as l,c as r,e as y,o as m,b as o,w as a,a as f,f as _,x as q,i as z,y as O,z as R,p as S,t as b,M as h}from"./index-BIwpTUVt.js";import{c as U,h as j}from"./kdDevice-BExDw8cT.js";const E={key:0},T={key:0},F={key:0,class:"device-status offline"},G={key:1,class:"device-status online"},H={key:2,class:"device-status alarm"},J={__name:"CqkdMouldLinkDevice",setup(C,{expose:g}){const i=D({show:!1,list:[]});function e(u){i.show=!0,i.list=u}return g({show:e}),(u,d)=>{const x=l("a-table"),w=l("a-modal");return i.show?(m(),r("div",E,[o(w,{title:"关联设备数",visible:i.show,"onUpdate:visible":d[0]||(d[0]=n=>i.show=n),width:"700px",footer:null},{default:a(()=>[i.show?(m(),r("div",T,[o(x,{"row-key":"id",data:i.list,class:"kd-small-table",bordered:!1,columns:[{title:"ID",dataIndex:"id"},{title:"设备名称",dataIndex:"name"},{title:"设备Code",dataIndex:"code"},{title:"设备状态",slotName:"status"},{title:"创建时间",dataIndex:"create_time"}]},{status:a(({record:n})=>[n.status===0?(m(),r("div",F,d[1]||(d[1]=[f("span",{class:"dot"},null,-1),_("离线")]))):n.status===1?(m(),r("div",G,d[2]||(d[2]=[f("span",{class:"dot"},null,-1),_("在线")]))):n.is_warning==1?(m(),r("div",H,d[3]||(d[3]=[f("span",{class:"dot"},null,-1),_("报警")]))):y("",!0)]),_:1},8,["data"])])):y("",!0)]),_:1},8,["visible"])])):y("",!0)}}},P=I(J,[["__scopeId","data-v-91a162aa"]]),Q={class:"kd-content"},W={key:0},X=["onClick"],Y=Object.assign({name:"DeviceMouldList"},{__name:"mould",setup(C){const g=q(),i=z(),e=D({loading:!1,search:{name:""},info:{page:1,limit:10,count:0,list:[]},selectId:[]});O(()=>{u(e.info.page,e.info.limit)});function u(n,t){e.info.page=n||e.info.page,e.info.limit=t||e.info.limit;let c={page:e.info.page,limit:e.info.limit};e.search.name&&(c.name=e.search.name),e.loading=!0,U(c).then(p=>{var v,k;e.loading=!1,p.code===200&&(e.info.list=((v=p.data)==null?void 0:v.list)||[],e.info.count=((k=p.data)==null?void 0:k.count)||0)}).catch(()=>{e.loading=!1})}function d(n){j({id:n}).then(t=>{if(t.code===200){h.success("删除成功"),u();return}h.error(t.msg)})}function x(){e.search.name="",u(1,e.info.limit)}const w=n=>i.value.show(n);return R(n=>{g.setKeepLive("DeviceMouldList",n.path==="/device/mouldAdd")}),(n,t)=>{const c=l("a-button"),p=l("router-link"),v=l("a-space"),k=l("a-input"),L=l("a-form-item"),M=l("a-form"),N=l("a-popconfirm"),V=l("a-table"),$=l("kd-pager"),A=l("a-card"),B=l("kd-page-box");return m(),S(B,null,{default:a(()=>[f("div",Q,[o(A,{title:"设备模板",bordered:!1},{extra:a(()=>[o(v,null,{default:a(()=>[o(p,{to:{path:"/device/mouldAdd"}},{default:a(()=>[o(c,{type:"primary"},{default:a(()=>t[3]||(t[3]=[f("i",{class:"ri-add-line"},null,-1),_("新增模板 ")])),_:1,__:[3]})]),_:1}),o(c,{disabled:!e.selectId.length},{default:a(()=>t[4]||(t[4]=[_("批量删除")])),_:1,__:[4]},8,["disabled"])]),_:1})]),default:a(()=>[o(M,{model:e.search,layout:"inline"},{default:a(()=>[o(L,{label:"模板名称"},{default:a(()=>[o(k,{modelValue:e.search.name,"onUpdate:modelValue":t[0]||(t[0]=s=>e.search.name=s),placeholder:"请输入模板名称",class:"w240"},null,8,["modelValue"]),o(c,{type:"primary",class:"ml10",onClick:t[1]||(t[1]=s=>u(1,e.info.limit))},{default:a(()=>t[5]||(t[5]=[_("查询")])),_:1,__:[5]}),o(c,{class:"ml10",onClick:x},{default:a(()=>t[6]||(t[6]=[_("重置")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),o(V,{class:"mt10 kd-small-table","row-key":"id",pagination:!1,bordered:!1,data:e.info.list,loading:e.loading,columns:[{title:"ID",dataIndex:"id",width:90},{title:"模板名称",dataIndex:"name"},{title:"变量总数",dataIndex:"variable_count",width:100},{title:"关联设备数",slotName:"device_count",width:120},{title:"采集方式",slotName:"collect",width:100},{title:"更新时间",dataIndex:"update_time"},{title:"操作",slotName:"action",width:140,fixed:"right"}],"row-selection":{type:"checkbox",showCheckedAll:!0,width:50},selectedKeys:e.selectId,"onUpdate:selectedKeys":t[2]||(t[2]=s=>e.selectId=s),scroll:{x:1e3}},{collect:a(({record:s})=>[f("span",null,b(s.collect===1?"云端轮询":""),1)]),device_count:a(({record:s})=>[s.device_count?(m(),r("span",{key:1,class:"kd-link",onClick:K=>w(s.device)},b(s.device_count),9,X)):(m(),r("span",W,"0"))]),action:a(({record:s})=>[o(p,{to:{path:"/device/mouldAdd",query:{id:s.id}}},{default:a(()=>[o(c,{type:"text",size:"mini",class:"ml-10"},{default:a(()=>t[7]||(t[7]=[_("编辑")])),_:1,__:[7]})]),_:2},1032,["to"]),o(N,{content:"确认删除设备模板吗？",onOk:K=>d(s.id)},{default:a(()=>[o(c,{type:"text",size:"mini"},{default:a(()=>t[8]||(t[8]=[_("删除")])),_:1,__:[8]})]),_:2},1032,["onOk"])]),_:1},8,["data","loading","selectedKeys"]),o($,{"page-data":e.info,event:u},null,8,["page-data"])]),_:1})]),o(P,{ref_key:"linkRef",ref:i},null,512)]),_:1})}}}),te=I(Y,[["__scopeId","data-v-ed8a1410"]]);export{te as default};
