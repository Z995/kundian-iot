import{g as f}from"./kdGateway-BVLUjIOd.js";import{l as B}from"./kdStatistics-Ct4QjyK5.js";import{r as L,j as N,p as c,w as n,d as l,o as m,a as y,b as s,c as C,F as G,l as Y,f as g,t as w}from"./index-whL21Ijk.js";const M={class:"kd-content"},U={__name:"gatewayOnlineRecord",setup(F){const e=L({loading:!1,search:{gateway_id:null,time:[]},info:{page:1,limit:10,count:0,list:[]},gateway:{list:[],page:1,key:""},selectId:[]});N(()=>{b(1),p(1,10)});function p(i,a){e.info.page=i||e.info.page,e.info.limit=a||e.info.limit;let o={page:e.info.page,limit:e.info.limit},{gateway_id:_,time:d}=e.search;_&&(o.gateway_id=_),d&&d.length&&(o.start_time=d[0],o.end_time=d[1]),e.loading=!0,B(o).then(r=>{e.loading=!1,e.info.list=r.data.list||[],e.info.count=r.data.count||0}).catch(()=>{e.loading=!1})}function k(i){e.gateway.key=i,e.gateway.page=1,f({page:1,limit:30,name:i}).then(o=>{e.gateway.list=o.data.list})}function b(i){e.gateway.page=1;let a={page:i,limit:30};e.gateway.key&&(a.name=e.gateway.key),f(a).then(o=>{e.gateway.list=o.data.list})}function v(){e.search={device_id:null,time:[]},p(1,e.info.limit)}return(i,a)=>{const o=l("a-option"),_=l("a-select"),d=l("a-range-picker"),r=l("a-button"),x=l("a-space"),u=l("a-tag"),V=l("a-table"),D=l("kd-pager"),I=l("a-card"),h=l("kd-page-box");return m(),c(h,null,{default:n(()=>[y("div",M,[s(I,{title:"网关上下线",bordered:!1},{default:n(()=>[s(x,null,{default:n(()=>[s(_,{class:"w160",placeholder:"请选择网关.",onSearch:k,modelValue:e.search.gateway_id,"onUpdate:modelValue":a[0]||(a[0]=t=>e.search.gateway_id=t),"filter-option":!1,"allow-search":"","allow-clear":"",onDropdownReachBottom:a[1]||(a[1]=t=>i.getDevice(e.gateway.page+1))},{default:n(()=>[(m(!0),C(G,null,Y(e.gateway.list,(t,H)=>(m(),c(o,{value:t.id,key:t.id},{default:n(()=>[g(w(t.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(d,{modelValue:e.search.time,"onUpdate:modelValue":a[2]||(a[2]=t=>e.search.time=t),class:"w340","show-time":"",format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"]),s(r,{type:"primary",onClick:a[3]||(a[3]=t=>p(1,e.info.limit))},{default:n(()=>a[4]||(a[4]=[g("查询")])),_:1,__:[4]}),s(r,{onClick:v},{default:n(()=>a[5]||(a[5]=[g("重置")])),_:1,__:[5]})]),_:1}),s(V,{class:"kd-small-table mt20",pagination:!1,"row-key":"id",bordered:!1,data:e.info.list,columns:[{title:"ID",dataIndex:"id"},{title:"网关名称",dataIndex:"name"},{title:"注册包",dataIndex:"code"},{title:"时间",dataIndex:"create_time"},{title:"状态",slotName:"status"},{title:"下线原因",slotName:"reason"}],loading:e.loading},{status:n(({record:t})=>[t.online===1?(m(),c(u,{key:0,color:"green"},{default:n(()=>a[6]||(a[6]=[g("上线")])),_:1,__:[6]})):(m(),c(u,{key:1,color:"orangered"},{default:n(()=>a[7]||(a[7]=[g("下线")])),_:1,__:[7]}))]),reason:n(({record:t})=>[y("span",null,w(t.reason||"-"),1)]),_:1},8,["data","loading"]),s(D,{"page-data":e.info,event:p},null,8,["page-data"])]),_:1})])]),_:1})}}};export{U as default};
