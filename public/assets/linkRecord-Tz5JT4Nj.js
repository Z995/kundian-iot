import{_ as k}from"./KdAlarmRecordSearch-DCTmg5Gi.js";import{m as x,n as h}from"./kdStatistics-Ct4QjyK5.js";import{r as b,j as v,p as I,w as o,d,o as _,a as y,b as l,f as w,c as N,e as D}from"./index-whL21Ijk.js";import"./kdDevice-DVsktYij.js";const B={class:"kd-content"},C={key:0},S={__name:"linkRecord",setup(L){const e=b({search:{},loading:!1,info:{list:[],page:1,limit:10,count:0},selectId:[]});v(()=>{c(1,10)});function m(n){e.search=n,c(1,e.info.limit)}function c(n,a){e.info.page=n||e.info.page,e.info.limit=a||e.info.limit;let i={page:e.info.page,limit:e.info.limit},t=e.search;t.device_id&&(i.device_id=t.device_id),t.variable_id&&(i.variable_id=t.variable_id),t.time&&t.time.length&&(i.start_time=t.time[0],i.end_time=t.time[1]),e.loading=!0,x(i).then(r=>{e.loading=!1,e.info.list=r.data.list||[],e.info.count=r.data.count||0}).catch(()=>{e.loading=!1})}function p(n){h({id:n}).then(a=>{if(a.code===200){Message.success("删除成功"),c();return}Message.error(a.msg)})}return(n,a)=>{const i=d("a-button"),t=d("a-popconfirm"),r=d("a-table"),g=d("kd-pager"),f=d("a-card"),u=d("kd-page-box");return _(),I(u,null,{default:o(()=>[y("div",B,[l(f,{title:"设备联动记录",bordered:!1},{default:o(()=>[l(k,{type:"linkRecord",onSearch:m}),l(r,{class:"kd-small-table mt20",pagination:!1,"row-key":"id",data:e.info.list,loading:e.loading,bordered:!1,"row-selection":{type:"checkbox",showCheckedAll:!0,width:50},selectedKeys:e.selectId,"onUpdate:selectedKeys":a[0]||(a[0]=s=>e.selectId=s),columns:[{title:"ID",dataIndex:"id",width:80},{title:"设备名称",dataIndex:"name"},{title:"触发器名称",dataIndex:"trigger_name"},{title:"触发器类型",slotName:"trigger_type"},{title:"从机名称",dataIndex:"subordinate_name"},{title:"变量名称",dataIndex:"variable_name"},{title:"触发条件",dataIndex:"trigger_condition"},{title:"触发设备",dataIndex:"trigger_device"},{title:"联动时间",dataIndex:"create_time"},{title:"操作",slotName:"action",width:80,fixed:"right"}],scroll:{x:1200}},{trigger_type:o(({record:s})=>[s.trigger_type===1?(_(),N("span",C,"设备")):D("",!0)]),action:o(({record:s})=>[l(t,{content:"确认删除联动记录吗?",onOk:V=>p(s.id)},{default:o(()=>[l(i,{type:"text",size:"mini"},{default:o(()=>a[1]||(a[1]=[w("删除")])),_:1,__:[1]})]),_:2},1032,["onOk"])]),_:1},8,["data","loading","selectedKeys"]),l(g,{"page-data":e.info,event:c},null,8,["page-data"])]),_:1})])]),_:1})}}};export{S as default};
