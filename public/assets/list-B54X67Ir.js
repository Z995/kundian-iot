import{g as U,d as j}from"./kdLive-C8hUdKlx.js";import{_ as F,r as I,d,c as u,e as m,o as l,b as n,w as i,a as o,F as E,k as K,u as G,v as N,m as H,p as J,l as f,f as _,t as b,n as z,q as Q,M as V}from"./index-B09Km9Qy.js";import{C as W}from"./CqkdPreviewLocalLive-CyHGIn3c.js";import{c as X}from"./constantData-BoRWJogH.js";const Y="/static/img/live/live-url.png",D="/static/img/select.png",Z={key:0},tt={class:"platform flex"},et={class:"platform-item"},it={key:0,class:"select-icon"},at={class:"pi-icon"},nt=["src"],lt={key:0,class:"select-icon"},ot={__name:"CqkdSelectPlatform",setup(R,{expose:C}){const p=I({show:!1,selectType:"",list:[{type:"kun_dian",icon:"kundian.png"},{type:3,icon:"haikang.png"},{type:6,icon:"lecheng.png"}]});function w(){p.show=!0}return C({showModal:w}),(a,s)=>{const g=d("router-link"),$=d("a-modal");return p.show?(l(),u("div",Z,[n($,{title:"选择监控平台",visible:p.show,"onUpdate:visible":s[0]||(s[0]=v=>p.show=v),width:"600px",footer:null},{default:i(()=>[o("div",tt,[n(g,{to:{path:"/live/addLive",query:{type:"local"}}},{default:i(()=>[o("div",et,[s[2]||(s[2]=o("div",{class:"custom-icon flex"},[o("img",{class:"icon-img",src:Y,alt:""}),o("div",{class:"pi-name"},"普通直播流")],-1)),p.selectType===1?(l(),u("div",it,s[1]||(s[1]=[o("img",{src:D,alt:""},null,-1)]))):m("",!0)])]),_:1}),(l(!0),u(E,null,K(p.list,(v,h)=>(l(),u("div",{class:"platform-item",key:h},[n(g,{to:{path:"/live/addLive",query:{type:v.type}}},{default:i(()=>[o("div",at,[o("img",{class:"icon-img",src:`/static/img/live/${v.icon}`,alt:""},null,8,nt)]),v.type===p.selectType?(l(),u("div",lt,s[3]||(s[3]=[o("img",{src:D,alt:""},null,-1)]))):m("",!0)]),_:2},1032,["to"])]))),128))])]),_:1},8,["visible"])])):m("",!0)}}},st=F(ot,[["__scopeId","data-v-c1bdb637"]]),dt={class:"kd-content"},_t={key:0},mt={key:1},pt={key:0},rt={class:"flex src-list"},ut={key:1},ft={key:2},ct=Object.assign({name:"LiveList"},{__name:"list",setup(R){const C=G(),p=N(),w=N(),a=I({loading:!1,search:{name:""},info:{page:1,limit:10,count:0,list:[]},selectId:[]});H(()=>{s(a.info.page,a.info.limit)});function s(c,t){a.info.page=c||a.info.page,a.info.limit=t||a.info.limit;let r={page:a.info.page,limit:a.info.limit};a.search.name&&(r.name=a.search.name),a.loading=!0,U(r).then(y=>{var x,L;a.loading=!1,y.code===200&&(a.info.list=((x=y.data)==null?void 0:x.list)||[],a.info.count=((L=y.data)==null?void 0:L.count)||0)}).catch(()=>{a.loading=!1})}function g(c){j({id:c}).then(t=>{if(t.code===200){V.success("删除成功"),s();return}V.error(t.msg)})}function $(){return p.value.showModal(),!1}function v(){a.search.name="",s(1,a.info.limit)}const h=c=>w.value.show(c);return J((c,t)=>{C.setKeepLive("LiveList",["/live/detail","/live/addLive"].includes(c.path))}),(c,t)=>{const r=d("a-button"),y=d("a-popconfirm"),x=d("a-space"),L=d("a-input"),B=d("a-form-item"),S=d("a-form"),k=d("a-tag"),q=d("router-link"),M=d("a-table"),O=d("kd-pager"),P=d("a-card"),T=d("kd-page-box");return l(),f(T,null,{default:i(()=>[o("div",dt,[n(P,{title:"监控列表",bordered:!1},{extra:i(()=>[n(x,null,{default:i(()=>[n(r,{type:"primary",onClick:t[0]||(t[0]=e=>$(null))},{default:i(()=>t[4]||(t[4]=[o("i",{class:"ri-add-line"},null,-1),_("新增监控 ")])),_:1,__:[4]}),n(y,{content:"确认删除监控吗?",onOk:t[1]||(t[1]=e=>g(a.selectId))})]),_:1})]),default:i(()=>[n(S,{model:a.search,layout:"inline"},{default:i(()=>[n(B,{label:"监控名称"},{default:i(()=>[n(L,{placeholder:"请输入监控名称",modelValue:a.search.name,"onUpdate:modelValue":t[2]||(t[2]=e=>a.search.name=e),class:"w300"},null,8,["modelValue"]),n(r,{type:"primary",class:"ml10",onClick:t[3]||(t[3]=e=>s(1,a.info.limit))},{default:i(()=>t[5]||(t[5]=[_("查询")])),_:1,__:[5]}),n(r,{class:"ml10",onClick:v},{default:i(()=>t[6]||(t[6]=[_("重置")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),n(M,{class:"mt10 kd-small-table","row-key":"id",pagination:!1,bordered:!1,data:a.info.list,loading:a.loading,columns:[{title:"ID",dataIndex:"id",width:80},{title:"状态",slotName:"status",width:120},{title:"监控信息",slotName:"name"},{title:"所属平台",slotName:"related_type"},{title:"操作",slotName:"action",width:230,fixed:"right"}]},{status:i(({record:e})=>[e.related_type==="local"?(l(),u("div",_t,"-")):m("",!0),e.related_type==="kun_dian"?(l(),u("div",mt,[e.state==="online"?(l(),f(k,{key:0,color:"#00CC66",size:"mini"},{default:i(()=>t[7]||(t[7]=[_("在线")])),_:1,__:[7]})):m("",!0),e.state==="offline"?(l(),f(k,{key:1,color:"gray",size:"mini"},{default:i(()=>t[8]||(t[8]=[_("离线")])),_:1,__:[8]})):m("",!0),e.state===""?(l(),f(k,{key:2,color:"gray",size:"mini"},{default:i(()=>t[9]||(t[9]=[_("未知")])),_:1,__:[9]})):m("",!0),e.state==="notReg"?(l(),f(k,{key:3,color:"#FF9933",size:"mini"},{default:i(()=>t[10]||(t[10]=[_("未注册")])),_:1,__:[10]})):m("",!0),e.state==="locked"?(l(),f(k,{key:4,color:"#FF3333",size:"mini"},{default:i(()=>t[11]||(t[11]=[_("锁定")])),_:1,__:[11]})):m("",!0)])):m("",!0)]),related_type:i(({record:e})=>[o("span",null,b(Q(X).livePlatform[e.related_type]),1)]),name:i(({record:e})=>[e.related_type==="local"?(l(),u("div",pt,[o("div",null,b(e.name),1),o("div",rt,[o("div",{class:z(["src-item",{active:e.hls}])},"m3u8",2),o("div",{class:z(["src-item",{active:e.flv}])},"flv",2),o("div",{class:z(["src-item",{active:e.rtmp}])},"rtmp",2)])])):e.related_type==="kun_dian"?(l(),u("div",ut,[o("div",null,b(e.desc||e.name),1)])):(l(),u("div",ft,[o("div",null,b(e.name),1)]))]),action:i(({record:e})=>[e.related_type==="local"?(l(),f(r,{key:0,type:"text",size:"mini",onClick:A=>h(e)},{default:i(()=>t[12]||(t[12]=[_(" 预览 ")])),_:2,__:[12]},1032,["onClick"])):(l(),f(q,{key:1,to:{path:"/live/detail",query:{type:e.related_type,id:e.id}}},{default:i(()=>[n(r,{type:"text",size:"mini"},{default:i(()=>t[13]||(t[13]=[_("详情")])),_:1,__:[13]})]),_:2},1032,["to"])),e.related_type!=="kun_dian"?(l(),f(q,{key:2,to:{path:"/live/addLive",query:{type:e.related_type,id:e.id}}},{default:i(()=>[n(r,{type:"text",size:"mini"},{default:i(()=>t[14]||(t[14]=[_("编辑")])),_:1,__:[14]})]),_:2},1032,["to"])):m("",!0),n(y,{content:"确认删除监控吗?",onOk:A=>g(e.id)},{default:i(()=>[n(r,{type:"text",size:"mini"},{default:i(()=>t[15]||(t[15]=[_("删除")])),_:1,__:[15]})]),_:2},1032,["onOk"])]),_:1},8,["data","loading"]),n(O,{"page-data":a.info,event:s},null,8,["page-data"])]),_:1})]),n(st,{ref_key:"platformRef",ref:p},null,512),n(W,{ref_key:"previewRef",ref:w},null,512)]),_:1})}}}),wt=F(ct,[["__scopeId","data-v-818c189f"]]);export{wt as default};
