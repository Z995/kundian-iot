import{i as U,r as j,d as n,p as k,o as v,w as t,e as q,b as l,f as a,a as I,j as N}from"./index-BIwpTUVt.js";const A={__name:"KdAlarmSetAdd",setup(C,{expose:V}){const i=U(),o=j({show:!1,form:{name:"",type:1,did:"",jizhi:1,method:[],user:[]}});function x(){o.show=!0}async function f(){if(await i.value.validate())return!1}return V({show:x}),(d,e)=>{const _=n("a-input"),m=n("a-form-item"),p=n("a-radio"),y=n("a-radio-group"),s=n("a-option"),g=n("a-select"),b=n("a-checkbox"),z=n("a-checkbox-group"),r=n("a-form"),w=n("a-drawer");return v(),k(w,{title:"添加报警配置",visible:o.show,"onUpdate:visible":e[7]||(e[7]=u=>o.show=u),"on-before-ok":f,width:"800px"},{default:t(()=>[o.show?(v(),k(r,{key:0,model:o.form,ref_key:"formRef",ref:i,"label-col-props":{flex:"130px"},"wrapper-col-props":{flex:1}},{default:t(()=>[l(m,{label:"报警配置名称",field:"name",rules:[{required:!0,message:"报警配置名称必填"}]},{default:t(()=>[l(_,{modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=u=>o.form.name=u),placeholder:"请输入报警配置名称",class:"w500"},null,8,["modelValue"])]),_:1}),l(m,{label:"推送类型",field:"type",rules:[{required:!0,message:"推送类型必选"}]},{default:t(()=>[l(y,{modelValue:o.form.type,"onUpdate:modelValue":e[1]||(e[1]=u=>o.form.type=u)},{default:t(()=>[l(p,{value:1},{default:t(()=>e[8]||(e[8]=[a("设备")])),_:1,__:[8]}),l(p,{value:2},{default:t(()=>e[9]||(e[9]=[a("模板触发器")])),_:1,__:[9]}),l(p,{value:3},{default:t(()=>e[10]||(e[10]=[a("独立触发器")])),_:1,__:[10]})]),_:1},8,["modelValue"])]),_:1}),o.form.type===1?(v(),k(m,{key:0,label:"选择设备",field:"did",rules:[{required:!0,message:"设备必选"}]},{default:t(()=>[l(g,{placeholder:"请选择设备",modelValue:o.form.did,"onUpdate:modelValue":e[2]||(e[2]=u=>o.form.did=u)},{default:t(()=>[l(s,null,{default:t(()=>e[11]||(e[11]=[a("设备1")])),_:1,__:[11]}),l(s,null,{default:t(()=>e[12]||(e[12]=[a("设备2")])),_:1,__:[12]}),l(s,null,{default:t(()=>e[13]||(e[13]=[a("设备3")])),_:1,__:[13]})]),_:1},8,["modelValue"])]),_:1})):(v(),k(m,{key:1,label:"选择触发器",field:"did",rules:[{required:!0,message:"触发器必选"}]},{default:t(()=>[l(g,{placeholder:"请选择触发器",modelValue:o.form.did,"onUpdate:modelValue":e[3]||(e[3]=u=>o.form.did=u)},{default:t(()=>[l(s,null,{default:t(()=>e[14]||(e[14]=[a("触发器1")])),_:1,__:[14]}),l(s,null,{default:t(()=>e[15]||(e[15]=[a("触发器2")])),_:1,__:[15]}),l(s,null,{default:t(()=>e[16]||(e[16]=[a("触发器3")])),_:1,__:[16]})]),_:1},8,["modelValue"])]),_:1})),l(m,{label:"推送机制",field:"jizhi",rules:[{required:!0,message:"推送机制必填"}]},{default:t(()=>[I("div",null,[e[20]||(e[20]=I("div",null,"变量值达到触发条件时",-1)),l(y,{direction:"vertical",modelValue:o.form.jizhi,"onUpdate:modelValue":e[4]||(e[4]=u=>o.form.jizhi=u)},{default:t(()=>[l(p,{value:1},{default:t(()=>e[17]||(e[17]=[a("仅第一次推送")])),_:1,__:[17]}),l(p,{value:2},{default:t(()=>[e[18]||(e[18]=a("报警沉默时间 ")),l(_,{class:"w120"}),e[19]||(e[19]=a(" 分钟"))]),_:1,__:[18,19]})]),_:1},8,["modelValue"])])]),_:1}),l(m,{label:"推送方式",field:"method",rules:[{required:!0,message:"推送方式必填"}]},{default:t(()=>[l(z,{modelValue:o.form.method,"onUpdate:modelValue":e[5]||(e[5]=u=>o.form.method=u)},{default:t(()=>[l(b,{value:"1"},{default:t(()=>e[21]||(e[21]=[a("短信")])),_:1,__:[21]}),l(b,{value:"2"},{default:t(()=>e[22]||(e[22]=[a("邮件")])),_:1,__:[22]}),l(b,{value:"3"},{default:t(()=>e[23]||(e[23]=[a("企业微信")])),_:1,__:[23]})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"推送人",field:"user",rules:[{required:!0,message:"推送人必选"}]},{default:t(()=>[l(g,{placeholder:"请选择推送人",modelValue:o.form.user,"onUpdate:modelValue":e[6]||(e[6]=u=>o.form.user=u),multiple:""},{default:t(()=>[l(s,null,{default:t(()=>e[24]||(e[24]=[a("用户1")])),_:1,__:[24]}),l(s,null,{default:t(()=>e[25]||(e[25]=[a("用户2")])),_:1,__:[25]}),l(s,null,{default:t(()=>e[26]||(e[26]=[a("用户3")])),_:1,__:[26]})]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"推送规则描述"},{default:t(()=>[l(_,{placeholder:"请输入推送规则描述",class:"w500"})]),_:1})]),_:1},8,["model"])):q("",!0)]),_:1},8,["visible"])}}},K={class:"kd-content"},$={__name:"alarmSet",setup(C){const V=U(),i=j({search:{},loading:!1,info:{list:[],page:1,limit:10,count:0},selectId:[]});N(()=>{o(1,10)});function o(f,d){i.info.page=f||i.info.page,i.info.limit=d||i.info.limit,i.info.page,i.info.limit,i.info.list=[{id:1,name:"farmtest报警配置",type:"独立触发器",main:"地下20cm水分低位预警",method:"短信、邮件",jizhi:"仅一次推送",status:1,update_time:"2025-04-17 11:34:31"},{id:2,name:"farmtest报警配置",type:"独立触发器",main:"-",method:"短信、邮件",jizhi:"仅一次推送",status:0,update_time:"2025-04-17 11:34:31"},{id:3,name:"farmtest报警配置",type:"独立触发器",main:"地下20cm水分低位预警",method:"短信、邮件",jizhi:"报警沉默时间10分钟",status:1,update_time:"2025-04-17 11:34:31"},{id:4,name:"farmtest报警配置",type:"独立触发器",main:"地下20cm水分低位预警",method:"短信、邮件",jizhi:"仅一次推送",status:0,update_time:"2025-04-17 11:34:31"}]}function x(f){V.value.show(f)}return(f,d)=>{const e=n("a-button"),_=n("a-space"),m=n("a-input"),p=n("a-switch"),y=n("a-popconfirm"),s=n("a-table"),g=n("kd-pager"),b=n("a-card"),z=n("kd-page-box");return v(),k(z,null,{default:t(()=>[I("div",K,[l(b,{title:"报警配置",bordered:!1},{extra:t(()=>[l(_,null,{default:t(()=>[l(e,{type:"primary",onClick:d[0]||(d[0]=r=>x(null))},{default:t(()=>d[3]||(d[3]=[I("i",{class:"ri-add-line"},null,-1),a("添加配置 ")])),_:1,__:[3]}),l(e,{disabled:!i.selectId.length},{default:t(()=>d[4]||(d[4]=[a("批量删除")])),_:1,__:[4]},8,["disabled"])]),_:1})]),default:t(()=>[l(_,null,{default:t(()=>[l(m,{placeholder:"请输入报警配置名称",class:"w300"}),l(e,{type:"primary",loading:i.loading,onClick:d[1]||(d[1]=r=>o(1,i.info.limit))},{default:t(()=>d[5]||(d[5]=[a("查询")])),_:1,__:[5]},8,["loading"]),l(e,{onClick:f.resetData},{default:t(()=>d[6]||(d[6]=[a("重置")])),_:1,__:[6]},8,["onClick"])]),_:1}),l(s,{class:"kd-small-table mt20",pagination:!1,"row-key":"id",data:i.info.list,loading:i.loading,bordered:!1,"row-selection":{type:"checkbox",showCheckedAll:!0,width:50},selectedKeys:i.selectId,"onUpdate:selectedKeys":d[2]||(d[2]=r=>i.selectId=r),columns:[{title:"ID",dataIndex:"id",width:80},{title:"报警配置名称",dataIndex:"name"},{title:"推送类型",dataIndex:"type"},{title:"推送主体",dataIndex:"main"},{title:"推送方式",dataIndex:"method"},{title:"推送机制",dataIndex:"jizhi"},{title:"状态",slotName:"status"},{title:"更新时间",dataIndex:"update_time"},{title:"操作",slotName:"action",width:130,fixed:"right"}],scroll:{x:1200}},{status:t(({record:r})=>[l(p,{modelValue:r.status,"onUpdate:modelValue":w=>r.status=w,"checked-value":1,"unchecked-value":0},null,8,["modelValue","onUpdate:modelValue"])]),action:t(({record:r})=>[l(e,{type:"text",size:"mini",class:"ml-10",onClick:w=>x(r)},{default:t(()=>d[7]||(d[7]=[a("编辑")])),_:2,__:[7]},1032,["onClick"]),l(y,{content:"确认删除报警配置吗?"},{default:t(()=>[l(e,{type:"text",size:"mini"},{default:t(()=>d[8]||(d[8]=[a("删除")])),_:1,__:[8]})]),_:1})]),_:1},8,["data","loading","selectedKeys"]),l(g,{"page-data":i.info,event:o},null,8,["page-data"])]),_:1})]),l(A,{ref_key:"addRef",ref:V},null,512)]),_:1})}}};export{$ as default};
