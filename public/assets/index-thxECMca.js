import{_ as g,c as o,o as a,h as S,i as j,d as f,b as _,w as p,a as e,r as T,j as V,e as C,F as m,k,t as l,f as z,n as q,M as D,l as F}from"./index-B09Km9Qy.js";import{u as A}from"./TianDiMap-CZQsJKr7.js";import{g as H,a as J,b as O}from"./kdDevice-C_HdGTFt.js";import{g as U}from"./kdStatistics-Bg0ou5-4.js";const E="/static/img/create-user.png",G="/static/img/create-wechat.jpg",K={},P={class:"service-box"};function Q(h,d){return a(),o("div",P,d[0]||(d[0]=[S('<img src="'+j+'" class="logo" alt="" data-v-14e9dbf2><div class="wechat-card flex" data-v-14e9dbf2><div class="wc-user mt20" data-v-14e9dbf2><img src="'+E+'" class="avatar" alt="" data-v-14e9dbf2><div class="name fb mt5" data-v-14e9dbf2>涂坤</div><div class="phone mt10" data-v-14e9dbf2>18723237733</div></div><div class="wc-qrcode" data-v-14e9dbf2><img src="'+G+'" class="qrcode" alt="" data-v-14e9dbf2></div></div>',2)]))}const R=g(K,[["render",Q],["__scopeId","data-v-14e9dbf2"]]),W={},X={class:"update-log"};function Y(h,d){const r=f("kd-empty");return a(),o("div",X,[_(r,{height:150})])}const Z=g(W,[["render",Y],["__scopeId","data-v-50dbd308"]]),ee={},te={class:"advert mt10"};function se(h,d){const r=f("a-carousel-item"),i=f("a-carousel");return a(),o("div",te,[_(i,{style:{width:"360px",height:"360px"},"show-arrow":"never"},{default:p(()=>[_(r,null,{default:p(()=>d[0]||(d[0]=[e("img",{src:"https://img.saas.farmkd.com/uploads/farm/2024/9/11/04aac7198af92a3c1dc0dac6bd20f572.png",style:{width:"100%",height:"360px"}},null,-1)])),_:1,__:[0]}),_(r,null,{default:p(()=>d[1]||(d[1]=[e("img",{src:"https://img.saas.farmkd.com/uploads/farm/2024/9/11/04aac7198af92a3c1dc0dac6bd20f572.png",style:{width:"100%",height:"360px"}},null,-1)])),_:1,__:[1]})]),_:1})])}const ie=g(ee,[["render",se],["__scopeId","data-v-d0a27240"]]),ae="/static/img/menu/device.png",ne={class:"device-map"},oe={class:"device-list"},ce={class:"dl-data"},de=["onClick"],le={class:"name"},re={key:0,class:"offline"},_e={key:1,class:"status"},ve={key:2,class:"warning"},ue={key:0,class:"dl-page"},fe={class:"dm-title"},me={class:"devce-name f14 fb"},pe={class:"flex-cb mt10"},ge={class:"dm-salve flex-c"},he=["onClick"],be={class:"dm-data"},ke={class:"dl-name"},xe={class:"f12 fb"},we={class:"mt10 time"},$e={class:"dl-val f20"},ye={class:"pull-icon"},Ce=["onClick"],De={__name:"CqkdDeviceMap",setup(h){const{initMap:d,setMapCenter:r,addBatchMarker:i,getCurrentLocation:x}=A(),t=T({info:{page:1,limit:15,count:0,list:[],listData:[]},device:{show:!1,info:null,data:[],salve_id:0}});V(()=>{d({el:"deviceMapBox",isSatellite:!0},()=>{x(),w()})});function w(){H({page:1,limit:999}).then(s=>{t.info.list=s.data.list,t.info.count=s.data.count,M(1,t.info.limit),i(t.info.list,{isClick:!0},v=>{console.log(v),t.device.show=!0,t.device.info=v,t.device.info.subordinate.length&&$(t.device.info.subordinate[0].id)})})}function M(c,s){t.info.page=c||t.info.page,t.info.limit=s||t.info.limit;const v=(t.info.page-1)*t.info.limit,y=v+t.info.limit;t.info.listData=t.info.list.slice(v,y)}const I=c=>{if(!c.longitude||!c.latitude)return D.warning("当前设备未设置定位信息"),!1;r(c.longitude,c.latitude)};function $(c){t.device.salve_id=c,B(c)}function B(c){J({subordinate_id:c}).then(s=>{t.device.data=s.data.list})}function L(c){O({variable_id:c}).then(s=>{if(s.code===200){D.success("采集成功"),$(t.device.salve_id);return}D.error(s.msg)})}return(c,s)=>{const v=f("kd-pager"),y=f("router-link");return a(),o("div",ne,[s[4]||(s[4]=e("div",{class:"device-map-box",id:"deviceMapBox"},null,-1)),e("div",oe,[s[1]||(s[1]=e("div",{class:"dl-title flex-cc"},[e("img",{src:ae,class:"title-icon mr10",alt:""}),e("span",null,"设备列表")],-1)),e("div",ce,[(a(!0),o(m,null,k(t.info.listData,(n,b)=>(a(),o("div",{class:"data-item flex-cb",key:b,onClick:u=>I(n)},[e("div",le,l(n.name),1),n.status===0?(a(),o("span",re," ● 离线")):n.status===1?(a(),o("span",_e," ● 在线")):n.is_warning===1?(a(),o("span",ve," ● 报警")):C("",!0)],8,de))),128))]),t.info.count>t.info.limit?(a(),o("div",ue,[_(v,{pageData:t.info,event:M,simple:!0,size:"mini",showJumper:!0},null,8,["pageData"])])):C("",!0)]),e("div",{class:q(["device-modal",t.device.show?"animate__bounceIn device-modal-show":"animate__bounceOut"])},[t.device.show&&t.device.info?(a(),o(m,{key:0},[e("div",{class:"close-icon",onClick:s[0]||(s[0]=n=>t.device.show=!1)},s[2]||(s[2]=[e("i",{class:"ri-close-line"},null,-1)])),e("div",fe,[e("div",me,l(t.device.info.name),1),e("div",pe,[e("span",null,l(t.device.info.code),1),_(y,{to:{path:"/device/deviceDetail",query:{id:t.device.info.id}}},{default:p(()=>s[3]||(s[3]=[e("span",{class:"more"},[z("查看详情 "),e("i",{class:"ri-arrow-right-s-line"})],-1)])),_:1,__:[3]},8,["to"])])]),e("div",ge,[(a(!0),o(m,null,k(t.device.info.subordinate,(n,b)=>{var u;return a(),o("div",{class:q(["salve-item",{active:t.device.salve_id===n.id}]),key:b,onClick:N=>$(n.id)},l((u=n.subordinate)==null?void 0:u.name),11,he)}),128))]),e("div",be,[(a(!0),o(m,null,k(t.device.data,(n,b)=>{var u;return a(),o("div",{class:"data-list flex-cb",key:n.id},[e("div",ke,[e("div",xe,l(n.name),1),e("div",we,l(n.update_time),1)]),e("div",$e,l(n.value)+" "+l((u=n.templateVariable)==null?void 0:u.unit),1),e("div",ye,[e("i",{class:"ri-refresh-line f20",onClick:N=>L(n.id)},null,8,Ce)])])}),128))])],64)):C("",!0)],2)])}}},Me=g(De,[["__scopeId","data-v-9e94b060"]]),qe={class:"index-page"},Te={class:"ip-card flex"},Ve={class:"ti-header flex-c"},Ie=["src"],Be={class:"item-right"},Le={class:"title"},Ne={class:"desc"},Se={class:"ti-val"},je={class:"fb val-data"},ze={class:"ip-content flex mt10"},Fe={class:"ip-map-box"},Ae={class:"ip-other"},He={__name:"index",setup(h){const d=T({list:[]});return V(()=>{U().then(r=>{console.log(r.data);let i=r.data;d.list=[{name:"设备总数 (台)",english:"Total number of devices",value:i.device_count||0,icon:"device.png",offline:1},{name:"网关总数 (台)",english:"Total number of gateways",value:i.gateway_count||0,icon:"gateway.png",offline:2},{name:"用户总数 (台)",english:"Total number of users",value:"",icon:"user.png"},{name:"今日变量报警 (台)",english:"Today varible alarm",value:i.warning_count||0,icon:"alarm.png"},{name:"监控总数 (台)",english:"Total number of monitoring",value:i.monitor_count||0,icon:"live.png",offline:3},{name:"今日联动数量 (台)",english:"Today linkage quantity",value:i.linkageLog_count||0,icon:"link.png"}]})}),(r,i)=>{const x=f("kd-page-box");return a(),F(x,null,{default:p(()=>[e("div",qe,[i[3]||(i[3]=e("div",{class:"ic-title fb"},"运营概况",-1)),e("div",Te,[(a(!0),o(m,null,k(d.list,(t,w)=>(a(),o("div",{class:"total-item",key:w},[e("div",Ve,[e("img",{src:"/static/img/home/"+t.icon,class:"icon-img",alt:""},null,8,Ie),e("div",Be,[e("div",Le,l(t.name),1),e("div",Ne,l(t.english),1)])]),e("div",Se,[e("span",je,l(t.value),1)])]))),128))]),e("div",ze,[e("div",Fe,[i[0]||(i[0]=e("div",{class:"ic-title fb"},"设备位置",-1)),_(Me)]),e("div",Ae,[i[1]||(i[1]=e("div",{class:"ic-title fb"},"官方客服",-1)),_(R),i[2]||(i[2]=e("div",{class:"ic-title fb mt10"},"更新日志",-1)),_(Z),_(ie)])])])]),_:1})}}},Ge=g(He,[["__scopeId","data-v-45fa4581"]]);export{Ge as default};
