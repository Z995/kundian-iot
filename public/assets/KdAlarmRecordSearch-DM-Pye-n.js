import{r as B,j as R,d as m,c as f,o as d,b as s,w as t,e as Y,F as h,k as g,l as V,f as r,t as w}from"./index-B09Km9Qy.js";import{g as A,f as M,a as F}from"./kdDevice-C_HdGTFt.js";const H={class:"search-box"},J={key:0},E={__name:"KdAlarmRecordSearch",props:{type:{type:String,default:"dataAlarmRerocrd"}},emits:["search"],setup(y,{emit:L}){const D=L,C=y,e=B({search:{name:"",device_id:null,slave_id:null,variable_id:null,time:[],is_warning:null,status:null},info:{page:1,limit:30,list:[]},slaveList:[],dataList:[]});R(async()=>{_(1,e.info.limit)});function _(n,a){e.info.page=n||e.info.page,e.info.limit=a||e.info.limit;let i={page:e.info.page,limit:e.info.limit},o=e.search;o&&o.name&&(i.name=o.name),A(i).then(u=>{var c,p;u.code===200&&(e.info.list=n===1?((c=u.data)==null?void 0:c.list)||[]:e.info.list.concat(((p=u.data)==null?void 0:p.list)||[]))})}function S(n){e.search.key=n,_(1,30)}function U(){e.search.name="",_(1,e.info.limit)}function x(){let{device_id:n}=e.search;if(e.search.slave_id=null,e.search.data_id=null,e.slaveList=[],e.dataList=[],!n)return!1;M({id:n}).then(a=>{var i;e.slaveList=((i=a.data)==null?void 0:i.subordinate)||[],D("changeDevice",a.data)})}function b(){e.search.data_id=null,e.dataList=[];let{slave_id:n}=e.search;if(!n)return!1;F({subordinate_id:n}).then(a=>{e.dataList=a.data.list||[]})}function k(){D("search",JSON.parse(JSON.stringify(e.search)))}function N(){e.search={name:"",device_id:null,slave_id:null,variable_id:null,time:[],is_warning:null,status:null},k()}return(n,a)=>{const i=m("a-option"),o=m("a-select"),u=m("a-range-picker"),c=m("a-button"),p=m("a-space");return d(),f("div",H,[s(p,null,{default:t(()=>[s(o,{class:"w160",placeholder:"请选择设备",modelValue:e.search.device_id,"onUpdate:modelValue":a[0]||(a[0]=l=>e.search.device_id=l),"allow-search":!0,"allow-clear":"",onSearch:S,"filter-option":!1,onClear:U,onDropdownReachBottom:a[1]||(a[1]=l=>_(e.info.page+1,e.info.limit)),onChange:x},{default:t(()=>[(d(!0),f(h,null,g(e.info.list,l=>(d(),V(i,{value:l.id},{default:t(()=>[r(w(l.name),1)]),_:2},1032,["value"]))),256))]),_:1},8,["modelValue"]),s(o,{placeholder:"请选择从机",class:"w160","allow-clear":"",modelValue:e.search.slave_id,"onUpdate:modelValue":a[2]||(a[2]=l=>e.search.slave_id=l),onChange:b,onClear:b},{default:t(()=>[(d(!0),f(h,null,g(e.slaveList,(l,v)=>(d(),V(i,{key:v,value:l.id},{default:t(()=>[r(w(l.subordinate.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),s(o,{placeholder:"请选择变量",class:"w160","allow-clear":"",modelValue:e.search.variable_id,"onUpdate:modelValue":a[3]||(a[3]=l=>e.search.variable_id=l)},{default:t(()=>[(d(!0),f(h,null,g(e.dataList,(l,v)=>(d(),V(i,{key:v,value:l.id},{default:t(()=>[r(w(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),C.type==="dataAlarmRerocrd"?(d(),f("div",J,[s(o,{placeholder:"报警状态",class:"w120","allow-clear":"",modelValue:e.search.is_warning,"onUpdate:modelValue":a[4]||(a[4]=l=>e.search.is_warning=l)},{default:t(()=>[s(i,{value:0},{default:t(()=>a[7]||(a[7]=[r("正常")])),_:1,__:[7]}),s(i,{value:1},{default:t(()=>a[8]||(a[8]=[r("报警")])),_:1,__:[8]})]),_:1},8,["modelValue"]),s(o,{placeholder:"处理状态",class:"w120","allow-clear":"",modelValue:e.search.status,"onUpdate:modelValue":a[5]||(a[5]=l=>e.search.status=l)},{default:t(()=>[s(i,{value:0},{default:t(()=>a[9]||(a[9]=[r("未处理")])),_:1,__:[9]}),s(i,{value:1},{default:t(()=>a[10]||(a[10]=[r("已处理")])),_:1,__:[10]})]),_:1},8,["modelValue"])])):Y("",!0),s(u,{class:"w340","show-time":"",format:"YYYY-MM-DD HH:mm","shortcuts-position":"left",shortcuts:e.rangeShortcuts,modelValue:e.search.time,"onUpdate:modelValue":a[6]||(a[6]=l=>e.search.time=l)},null,8,["shortcuts","modelValue"]),s(c,{type:"primary",onClick:k},{default:t(()=>a[11]||(a[11]=[r("查询")])),_:1,__:[11]}),s(c,{onClick:N},{default:t(()=>a[12]||(a[12]=[r("重置")])),_:1,__:[12]})]),_:1})])}}};export{E as _};
