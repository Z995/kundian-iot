import{d as A,e as T}from"./kdLive-CKaDh8Mo.js";import{_ as D,r as I,d,c,e as r,o as s,b as n,w as a,a as l,x as j,i as N,y as E,z as K,p as f,f as m,t as b,n as V,u as G,M as q}from"./index-whL21Ijk.js";import{C as H}from"./CqkdPreviewLocalLive-Dr49pAvv.js";import{c as J}from"./constantData-DLrCubd0.js";import"./CqkdPlayJessibuca-CH0ScjDG.js";const Q="/static/img/live/live-common.png",W="/static/img/live/live-gb.png",X={key:0},Y={class:"platform flex"},Z={__name:"CqkdSelectPlatform",setup(R,{expose:C}){const _=I({show:!1,selectType:"",list:[{type:"kun_dian",icon:"live-gb.png"},{type:3,icon:"haikang.png"},{type:6,icon:"lecheng.png"}]});function w(){_.show=!0}return C({showModal:w}),(i,o)=>{const y=d("router-link"),z=d("a-modal");return _.show?(s(),c("div",X,[n(z,{title:"选择监控协议",visible:_.show,"onUpdate:visible":o[2]||(o[2]=k=>_.show=k),width:"600px",footer:null},{default:a(()=>[l("div",Y,[n(y,{to:{path:"/live/addLive",query:{type:"local"}}},{default:a(()=>[l("div",{class:"platform-item",onClick:o[0]||(o[0]=k=>_.show=!1)},o[3]||(o[3]=[l("img",{class:"pi-icon",src:Q,alt:""},null,-1),l("div",{class:"pi-name"},"普通直播流地址",-1)]))]),_:1}),n(y,{to:{path:"/live/addLive",query:{type:"kun_dian"}}},{default:a(()=>[l("div",{class:"platform-item",onClick:o[1]||(o[1]=k=>_.show=!1)},o[4]||(o[4]=[l("img",{class:"pi-icon",src:W,alt:""},null,-1),l("div",{class:"pi-name"},"国标监控",-1)]))]),_:1})])]),_:1},8,["visible"])])):r("",!0)}}},tt=D(Z,[["__scopeId","data-v-10f3dab1"]]),et={class:"kd-content"},at={key:0},it={key:1},nt={key:0},ot={class:"flex src-list"},lt={key:1},st={key:2},dt=Object.assign({name:"LiveList"},{__name:"list",setup(R){const C=j(),_=N(),w=N(),i=I({loading:!1,search:{name:""},info:{page:1,limit:10,count:0,list:[]},selectId:[]});E(()=>{o(i.info.page,i.info.limit)});function o(u,t){i.info.page=u||i.info.page,i.info.limit=t||i.info.limit;let p={page:i.info.page,limit:i.info.limit};i.search.name&&(p.name=i.search.name),i.loading=!0,A(p).then(v=>{var x,L;i.loading=!1,v.code===200&&(i.info.list=((x=v.data)==null?void 0:x.list)||[],i.info.count=((L=v.data)==null?void 0:L.count)||0)}).catch(()=>{i.loading=!1})}function y(u){T({id:u}).then(t=>{if(t.code===200){q.success("删除成功"),o();return}q.error(t.msg)})}function z(){return _.value.showModal(),!1}function k(){i.search.name="",o(1,i.info.limit)}const h=u=>w.value.show(u);return K((u,t)=>{C.setKeepLive("LiveList",["/live/detail","/live/addLive"].includes(u.path))}),(u,t)=>{const p=d("a-button"),v=d("a-popconfirm"),x=d("a-space"),L=d("a-input"),B=d("a-form-item"),F=d("a-form"),g=d("a-tag"),$=d("router-link"),M=d("a-table"),S=d("kd-pager"),O=d("a-card"),P=d("kd-page-box");return s(),f(P,null,{default:a(()=>[l("div",et,[n(O,{title:"监控列表",bordered:!1},{extra:a(()=>[n(x,null,{default:a(()=>[n(p,{type:"primary",onClick:t[0]||(t[0]=e=>z(null))},{default:a(()=>t[4]||(t[4]=[l("i",{class:"ri-add-line"},null,-1),m("新增监控 ")])),_:1,__:[4]}),n(v,{content:"确认删除监控吗?",onOk:t[1]||(t[1]=e=>y(i.selectId))})]),_:1})]),default:a(()=>[n(F,{model:i.search,layout:"inline"},{default:a(()=>[n(B,{label:"监控名称"},{default:a(()=>[n(L,{placeholder:"请输入监控名称",modelValue:i.search.name,"onUpdate:modelValue":t[2]||(t[2]=e=>i.search.name=e),class:"w300"},null,8,["modelValue"]),n(p,{type:"primary",class:"ml10",onClick:t[3]||(t[3]=e=>o(1,i.info.limit))},{default:a(()=>t[5]||(t[5]=[m("查询")])),_:1,__:[5]}),n(p,{class:"ml10",onClick:k},{default:a(()=>t[6]||(t[6]=[m("重置")])),_:1,__:[6]})]),_:1})]),_:1},8,["model"]),n(M,{class:"mt10 kd-small-table","row-key":"id",pagination:!1,bordered:!1,data:i.info.list,loading:i.loading,columns:[{title:"ID",dataIndex:"id",width:80},{title:"状态",slotName:"status",width:120},{title:"监控信息",slotName:"name"},{title:"监控协议",slotName:"related_type"},{title:"操作",slotName:"action",width:230,fixed:"right"}]},{status:a(({record:e})=>[e.related_type==="local"?(s(),c("div",at,"-")):r("",!0),e.related_type==="kun_dian"?(s(),c("div",it,[e.state==="online"?(s(),f(g,{key:0,color:"#00CC66",size:"mini"},{default:a(()=>t[7]||(t[7]=[m("在线")])),_:1,__:[7]})):r("",!0),e.state==="offline"?(s(),f(g,{key:1,color:"gray",size:"mini"},{default:a(()=>t[8]||(t[8]=[m("离线")])),_:1,__:[8]})):r("",!0),e.state===""?(s(),f(g,{key:2,color:"gray",size:"mini"},{default:a(()=>t[9]||(t[9]=[m("未知")])),_:1,__:[9]})):r("",!0),e.state==="notReg"?(s(),f(g,{key:3,color:"#FF9933",size:"mini"},{default:a(()=>t[10]||(t[10]=[m("未注册")])),_:1,__:[10]})):r("",!0),e.state==="locked"?(s(),f(g,{key:4,color:"#FF3333",size:"mini"},{default:a(()=>t[11]||(t[11]=[m("锁定")])),_:1,__:[11]})):r("",!0)])):r("",!0)]),related_type:a(({record:e})=>[l("span",null,b(G(J).livePlatform[e.related_type]),1)]),name:a(({record:e})=>[e.related_type==="local"?(s(),c("div",nt,[l("div",null,b(e.name),1),l("div",ot,[l("div",{class:V(["src-item",{active:e.hls}])},"M3U8",2),l("div",{class:V(["src-item",{active:e.flv}])},"FLV",2)])])):e.related_type==="kun_dian"?(s(),c("div",lt,[l("div",null,b(e.desc||e.name),1)])):(s(),c("div",st,[l("div",null,b(e.name),1)]))]),action:a(({record:e})=>[e.related_type==="local"?(s(),f(p,{key:0,type:"text",size:"mini",onClick:U=>h(e)},{default:a(()=>t[12]||(t[12]=[m(" 预览 ")])),_:2,__:[12]},1032,["onClick"])):(s(),f($,{key:1,to:{path:"/live/detail",query:{type:e.related_type,id:e.id}}},{default:a(()=>[n(p,{type:"text",size:"mini"},{default:a(()=>t[13]||(t[13]=[m("详情")])),_:1,__:[13]})]),_:2},1032,["to"])),e.related_type!=="kun_dian"?(s(),f($,{key:2,to:{path:"/live/addLive",query:{type:e.related_type,id:e.id}}},{default:a(()=>[n(p,{type:"text",size:"mini"},{default:a(()=>t[14]||(t[14]=[m("编辑")])),_:1,__:[14]})]),_:2},1032,["to"])):r("",!0),n(v,{content:"确认删除监控吗?",onOk:U=>y(e.id)},{default:a(()=>[n(p,{type:"text",size:"mini"},{default:a(()=>t[15]||(t[15]=[m("删除")])),_:1,__:[15]})]),_:2},1032,["onOk"])]),_:1},8,["data","loading"]),n(S,{"page-data":i.info,event:o},null,8,["page-data"])]),_:1})]),n(tt,{ref_key:"platformRef",ref:_},null,512),n(H,{ref_key:"previewRef",ref:w},null,512)]),_:1})}}}),ut=D(dt,[["__scopeId","data-v-2142afa8"]]);export{ut as default};
