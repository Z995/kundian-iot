import{i as D}from"./index-Bb6yjXMn.js";import{a as T,b as F,c as A,d as K,e as P,f as E}from"./kdStatistics-Bg0ou5-4.js";import{_ as b,j as h,c as u,o as p,r as I,a as e,F as O,k as R,t as g,D as j,d as x,b as f,l as B,e as L,n as $,w as N,v as k}from"./index-B09Km9Qy.js";const G=["id"],M={__name:"KdTotalPie",props:{canvasId:{type:String,default:"dataPie"},type:{type:String,default:"deviceStatus"}},setup(v){const d=v;let c=null;h(()=>{d.type==="deviceStatus"&&T().then(t=>{var s,o,n;let a=[{name:"在线",value:((s=t.data)==null?void 0:s.online)||0},{name:"变量报警",value:((o=t.data)==null?void 0:o.warning)||0},{name:"离线",value:((n=t.data)==null?void 0:n.not_online)||0}];i(a)}),d.type==="deviceLabel"&&F().then(t=>{let a=t.data||[],s=[];a.forEach(n=>{s.push({name:n.name,value:n.count})}),s.sort((n,r)=>r.value-n.value);let o=s.slice(0,7);i(o)}),d.type==="gatewayStatus"&&A().then(t=>{var s,o,n;let a=[{name:"在线",value:((s=t.data)==null?void 0:s.online)||0},{name:"报警",value:((o=t.data)==null?void 0:o.warning)||0},{name:"离线",value:((n=t.data)==null?void 0:n.not_online)||0}];i(a)})});function i(t){var a=document.getElementById(d.canvasId);c=D(a);let s={color:["#3c78ff","#ff9659","#c0cff3","#00CC66","#00CCFF","#6666FF","#CC33CC","#FF66CC","#009966"],tooltip:{trigger:"item"},legend:{bottom:"0",left:"center"},series:[{type:"pie",radius:["30%","50%"],center:["40%","50%"],label:{show:!0,formatter:function(o){return`${o.name}(${o.value})`}},labelLine:{show:!0},itemStyle:{borderWidth:5,borderColor:"#fff"},data:t}]};s&&c.setOption(s)}return(t,a)=>(p(),u("div",{class:"total-pie",id:d.canvasId},null,8,G))}},w=b(M,[["__scopeId","data-v-f6439594"]]),V={class:"alarm-box"},W={class:"alarm-item flex"},z={class:"f12 ait-desc"},q={class:"mt10 fb"},H={class:"total"},J={class:"f12"},Q={__name:"KdTotalAlarm",setup(v){const d=I({list:[]});return h(()=>{K().then(c=>{d.list=c.data})}),(c,i)=>(p(),u("div",V,[e("div",W,[i[0]||(i[0]=e("div",{class:"ai-title fb"},"设备报警",-1)),(p(!0),u(O,null,R(d.list,(t,a)=>(p(),u("div",{class:"ai-today",key:a},[e("div",z,g(t.day)+"报警（已处理/未处理）",1),e("div",q,[e("span",H,g(t.count),1),e("span",J,"("+g(t.disposed_count)+"/"+g(t.undisposed_count)+")",1)])]))),128))])]))}},U=b(Q,[["__scopeId","data-v-5ed99bc1"]]),X={class:"line-box"},Y={class:"date flex mb10 fb"},Z=["id"],tt={__name:"KdLineAdd",props:{canvasId:{type:String,default:"dataLine"},type:{type:String,default:"deviceNew"}},setup(v,{expose:d}){let c=null;const i=v,t=I({loading:!1,type:1,list:[]});h(()=>{i.type==="deviceNew"&&a(),i.type==="gatewayNew"&&s()});function a(){let r={type:t.type};t.loading=!0,P(r).then(l=>{t.loading=!1,t.list=l.data,setTimeout(function(){n(l.data)},500)}).catch(()=>{t.loading=!1})}function s(){let r={type:t.type};t.loading=!0,E(r).then(l=>{t.loading=!1,t.list=l.data,setTimeout(function(){n(l.data)},500)}).catch(()=>{t.loading=!1})}function o(r){t.type=r,i.type==="deviceNew"&&a(),i.type==="gatewayNew"&&s()}function n(r){if(!r.length)return!1;if(!c){var l=document.getElementById(i.canvasId);c=D(l)}let _=[],y=[];r.forEach(C=>{_.push(j(C.date).format("MM/DD")),y.push(parseInt(C.count))});let m={color:["#3c78ff"],grid:{left:"5%",right:"5%",bottom:"5%",top:"5%",containLabel:!0},tooltip:{trigger:"axis"},xAxis:{type:"category",data:_},yAxis:{type:"value",splitLine:{lineStyle:{type:"dashed"}}},series:[{name:"新增设备",data:y,type:"bar",barWidth:20,itemStyle:{borderRadius:[4,4,0,0]}}]};m&&c.setOption(m)}return d({drawData:n}),(r,l)=>{const _=x("a-spin"),y=x("kd-empty");return p(),u("div",X,[e("div",Y,[e("div",{class:$(["data-item",{active:t.type===1}]),onClick:l[0]||(l[0]=m=>o(1))},"近七日",2),e("div",{class:$(["data-item",{active:t.type===2}]),onClick:l[1]||(l[1]=m=>o(2))},"最近一个月",2)]),f(_,{loading:t.loading,style:{width:"100%",height:"300px"},tip:"数据加载中..."},{default:N(()=>[t.list.length?(p(),u("div",{key:0,class:"line-add",id:i.canvasId},null,8,Z)):L("",!0)]),_:1},8,["loading"]),t.list.length?L("",!0):(p(),B(y,{key:0,height:300}))])}}},S=b(tt,[["__scopeId","data-v-8170c838"]]),et={class:"total-box flex"},at={class:"total-item"},st={class:"total-item"},it={class:"total-item"},nt={class:"kd-content mt20"},ot={class:"add-box flex mt20"},dt={class:"add-item"},lt={class:"add-item"},ct={__name:"index",setup(v){const d=k(),c=k();return h(()=>{}),(i,t)=>{const a=x("kd-page-box");return p(),B(a,null,{default:N(()=>[e("div",et,[e("div",at,[t[0]||(t[0]=e("div",{class:"ti-title f12 fb"},"设备状态统计",-1)),f(w,{type:"deviceStatus","canvas-id":"statusPine"})]),e("div",st,[t[1]||(t[1]=e("div",{class:"ti-title f12 fb"},"设备标签统计",-1)),f(w,{type:"deviceLabel","canvas-id":"labelPine"})]),e("div",it,[t[2]||(t[2]=e("div",{class:"ti-title f12 fb"},"网关状态统计",-1)),f(w,{type:"gatewayStatus","canvas-id":"gatewayPine"})])]),e("div",nt,[t[3]||(t[3]=e("div",{class:"ti-title f12 fb mb10"},"报警统计",-1)),f(U)]),e("div",ot,[e("div",dt,[t[4]||(t[4]=e("div",{class:"ti-title f12 fb mb10"},"新增设备",-1)),f(S,{type:"deviceNew",ref_key:"deviceLineRef",ref:d,"canvas-id":"deviceLine"},null,512)]),e("div",lt,[t[5]||(t[5]=e("div",{class:"ti-title f12 fb mb10"},"新增网关",-1)),f(S,{type:"gatewayNew",ref_key:"gatewayLineRef",ref:c,"canvas-id":"gatewayLine"},null,512)])])]),_:1})}}},ut=b(ct,[["__scopeId","data-v-daef7032"]]);export{ut as default};
