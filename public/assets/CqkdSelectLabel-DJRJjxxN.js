import{s as b,_ as T,r as U,d as y,c,e as q,o as u,b as f,w as _,a as n,F as C,l as v,t as w,f as m,C as g,n as F,M as i,D as z}from"./index-BIwpTUVt.js";const k="/admin/label/";function A(d){return b({url:`${k}getLabelCategoryList`,method:"get",params:d})}function j(d){return b({url:`${k}saveLabelCategory`,method:"post",data:d})}function G(d){return b({url:`${k}delLabelCategory`,method:"post",data:d})}function H(d){return b({url:`${k}saveLabel`,method:"post",data:d})}function J(d){return b({url:`${k}delLabel`,method:"post",data:d})}const K={key:0},P={class:"label-box"},Q={class:"flex-cb"},R={class:"label-name f17"},W={class:"label-ul flex"},X=["onClick"],Y=["onClick"],Z=["onClick"],ee={class:"footer-box mt20 flex-c"},te={__name:"CqkdSelectLabel",emits:["success"],setup(d,{expose:L,emit:x}){const $=x,t=U({show:!1,list:[],show_add_type:!1,form:{type_name:"",label_name:""},checkedList:[]});function D(l){if(t.show=!0,l&&l.length){let e=[];l.forEach(s=>e.push(parseInt(s))),t.checkedList=e}p()}async function p(){var e;let l=await A();t.list=((e=l.data)==null?void 0:e.list)||[],t.list.forEach(s=>{s.label&&s.label.length&&s.label.forEach(r=>{r.is_checked=t.checkedList.includes(r.id)})})}function V(){let{type_name:l}=t.form;if(!l)return i.warning("请输入类别名称"),!1;j({name:l}).then(e=>{if(e.code===200)return i.success("添加成功"),t.form.type_name="",t.show_add_type=!1,p(),!1;i.error(e.msg)})}function E(l){G({id:l}).then(e=>{if(e.code===200){i.success("删除成功"),p();return}i.error(e.msg)})}function I(l){let{label_name:e}=t.form;if(!e)return i.warning("请输入标签名称"),!1;H({name:e,category_id:l}).then(s=>{if(s.code===200){i.success("添加成功"),t.form.label_name="";let r=t.list.findIndex(h=>h.id==l);return t.list[r].show_add=!1,p(),!1}i.error(s.msg)})}function M(l){z.confirm({title:"提示",content:"确认删除标签吗？",onOk:()=>{J({id:l}).then(e=>{if(e.code===200){i.success("删除成功"),p();return}i.error(e.msg)})}})}function N(){let l=[],e=[];if(t.list.forEach(s=>{s.label&&s.label.length&&s.label.forEach(r=>{r.is_checked&&(l.push(r),e.push(r.id))})}),!e.length)return i.warning("请选择标签"),!1;$("success",{id:e,list:l}),t.show=!1}return L({show:D}),(l,e)=>{const s=y("a-button"),r=y("a-popconfirm"),h=y("a-input"),S=y("a-modal");return t.show?(u(),c("div",K,[f(S,{title:"选择标签",visible:t.show,"onUpdate:visible":e[4]||(e[4]=a=>t.show=a),width:"800px","on-before-ok":N,"mask-closable":!1},{default:_(()=>[n("div",P,[(u(!0),c(C,null,v(t.list,(a,B)=>(u(),c("div",{class:"label-item",key:B},[n("div",Q,[n("span",R,w(a.name),1),f(r,{content:"确认删除类别吗？",onOk:o=>E(a.id)},{default:_(()=>[f(s,{type:"text",status:"danger"},{default:_(()=>e[5]||(e[5]=[n("i",{class:"ri-delete-bin-2-line mr5"},null,-1),m("删除类别 ")])),_:1,__:[5]})]),_:2},1032,["onOk"])]),n("div",W,[(u(!0),c(C,null,v(a.label,(o,le)=>(u(),c("div",{class:F(["label-ul-li",{active:o.is_checked}]),onClick:g(O=>o.is_checked=!o.is_checked,["stop"])},[m(w(o.name)+" ",1),n("div",{class:"del-icon",onClick:g(O=>M(o.id),["stop"])},e[6]||(e[6]=[n("i",{class:"ri-close-line"},null,-1)]),8,Y),e[7]||(e[7]=n("div",{class:"check-icon"},[n("i",{class:"ri-check-line"})],-1))],10,X))),256)),a.show_add?(u(),c(C,{key:0},[f(h,{placeholder:"请输入标签名称",modelValue:t.form.label_name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.form.label_name=o),class:"w160"},null,8,["modelValue"]),f(s,{onClick:o=>a.show_add=!1},{default:_(()=>e[8]||(e[8]=[m("取消")])),_:2,__:[8]},1032,["onClick"]),f(s,{type:"primary",onClick:o=>I(a.id)},{default:_(()=>e[9]||(e[9]=[m("添加")])),_:2,__:[9]},1032,["onClick"])],64)):(u(),c("div",{key:1,class:"add-label",onClick:o=>a.show_add=!0},e[10]||(e[10]=[n("i",{class:"ri-add-line"},null,-1),m("添加标签 ")]),8,Z))])]))),128))]),n("div",ee,[t.show_add_type?(u(),c(C,{key:0},[f(h,{placeholder:"请输入类别名称",modelValue:t.form.type_name,"onUpdate:modelValue":e[1]||(e[1]=a=>t.form.type_name=a),class:"w160"},null,8,["modelValue"]),f(s,{class:"ml10",onClick:e[2]||(e[2]=a=>t.show_add_type=!1)},{default:_(()=>e[11]||(e[11]=[m("取消")])),_:1,__:[11]}),f(s,{type:"primary",class:"ml10",onClick:V},{default:_(()=>e[12]||(e[12]=[m("添加")])),_:1,__:[12]})],64)):(u(),c("div",{key:1,class:"add-label",onClick:e[3]||(e[3]=a=>t.show_add_type=!0)},e[13]||(e[13]=[n("i",{class:"ri-add-line"},null,-1),m("新建类别 ")])))])]),_:1},8,["visible"])])):q("",!0)}}},ae=T(te,[["__scopeId","data-v-ac977633"]]);export{ae as C};
