import{i as I,l as N,m as P}from"./kdDevice-DVsktYij.js";import{x as A,r as B,y as S,z,p as O,w as a,d as o,o as U,a as r,b as n,f as u,M as p}from"./index-whL21Ijk.js";const $={class:"kd-content"},K=Object.assign({name:"DeviceProductList"},{__name:"product",setup(M){const _=A(),t=B({loading:!1,search:{name:""},info:{page:1,limit:10,count:0,list:[]}});S(()=>{d(t.info.page,t.info.limit)});function d(i,e){t.info.page=i||t.info.page,t.info.limit=e||t.info.limit;let s={page:t.info.page,limit:t.info.limit};t.search.name&&(s.name=t.search.name),t.loading=!0,I(s).then(c=>{t.loading=!1,t.info.list=c.data.list,t.info.count=c.data.count}).catch(()=>{t.loading=!1})}function f(i){N({id:i}).then(e=>{if(e.code===200){p.success("删除成功"),d();return}p.error(e.msg)})}async function g(i){await P({id:i.id,status:i.status})}function k(){t.search.name="",d(1,t.info.limit)}return z(i=>{_.setKeepLive("DeviceProductList",i.path==="/device/productAdd")}),(i,e)=>{const s=o("a-button"),c=o("router-link"),v=o("a-space"),x=o("a-input"),h=o("a-form-item"),b=o("a-form"),y=o("a-switch"),V=o("a-popconfirm"),w=o("a-table"),C=o("kd-pager"),D=o("a-card"),L=o("kd-page-box");return U(),O(L,null,{default:a(()=>[r("div",$,[n(D,{title:"产品库",bordered:!1},{extra:a(()=>[n(v,null,{default:a(()=>[n(c,{to:{path:"/device/productAdd"}},{default:a(()=>[n(s,{type:"primary"},{default:a(()=>e[2]||(e[2]=[r("i",{class:"ri-add-line"},null,-1),u("新增产品 ")])),_:1,__:[2]})]),_:1})]),_:1})]),default:a(()=>[n(b,{model:t.search,layout:"inline"},{default:a(()=>[n(h,{label:"产品名称"},{default:a(()=>[n(x,{modelValue:t.search.name,"onUpdate:modelValue":e[0]||(e[0]=l=>t.search.name=l),placeholder:"请输入产品名称",class:"w240"},null,8,["modelValue"]),n(s,{type:"primary",class:"ml10",onClick:e[1]||(e[1]=l=>d(1,t.info.limit))},{default:a(()=>e[3]||(e[3]=[u("查询")])),_:1,__:[3]}),n(s,{class:"ml10",onClick:k},{default:a(()=>e[4]||(e[4]=[u("重置")])),_:1,__:[4]})]),_:1})]),_:1},8,["model"]),n(w,{class:"mt10 kd-small-table","row-key":"id",pagination:!1,bordered:!1,data:t.info.list,loading:t.loading,columns:[{title:"ID",dataIndex:"id",width:90},{title:"产品名称",dataIndex:"name"},{title:"变量数",dataIndex:"link_data"},{title:"状态",slotName:"status"},{title:"创建时间",dataIndex:"create_time"},{title:"操作",slotName:"action",width:130,fixed:"right"}]},{status:a(({record:l})=>[n(y,{modelValue:l.status,"onUpdate:modelValue":m=>l.status=m,"checked-value":1,"unchecked-value":0,"checked-text":"启用","unchecked-text":"禁用",onChange:m=>g(l)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),action:a(({record:l})=>[n(c,{to:{path:"/device/productAdd",query:{id:l.id}}},{default:a(()=>[n(s,{type:"text",size:"mini"},{default:a(()=>e[5]||(e[5]=[u("编辑")])),_:1,__:[5]})]),_:2},1032,["to"]),n(V,{content:"确认删除产品吗？",onOk:m=>f(l.id)},{default:a(()=>[n(s,{type:"text",size:"mini"},{default:a(()=>e[6]||(e[6]=[u("删除")])),_:1,__:[6]})]),_:2},1032,["onOk"])]),_:1},8,["data","loading"]),n(C,{"page-data":t.info,event:d},null,8,["page-data"])]),_:1})])]),_:1})}}});export{K as default};
